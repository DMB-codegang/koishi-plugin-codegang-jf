# å¿«é€Ÿä¸Šæ‰‹
è¿™ç¯‡æ–‡æ¡£å°†ç²—ç•¥æ¦‚è¿°æ’ä»¶çš„åŸºæœ¬å†…å®¹

## å®‰è£…æ’ä»¶

é€šè¿‡[koishiæ’ä»¶å¸‚åœº](https://koishi.chat/zh-CN/market/)å®‰è£…

## é…ç½®

### åŸºç¡€è®¾ç½®
| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ | å¯ç”¨æ¡ä»¶ |
|--------|------|--------|------|---------|
| **check_jf_command_set** | boolean | true | å¯ç”¨ç§¯åˆ†æŸ¥è¯¢æŒ‡ä»¤ | å§‹ç»ˆå¯ç”¨ |
| **check_jf_command** | string | `ä½ çš„ç§¯åˆ†æ˜¯{jf}` | æŸ¥è¯¢å“åº”æ¨¡æ¿ | check_jf_command_set=true |

### æ—¥å¿—è®¾ç½®
| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ | å¯ç”¨æ¡ä»¶ |
|--------|------|--------|------|---------|
| **log** | boolean | true | å¯ç”¨æ—¥å¿—ç³»ç»Ÿ | å§‹ç»ˆå¯ç”¨ |
| **only_success** | boolean | true | ä»…è®°å½•æˆåŠŸæ“ä½œ | log=true |
| **max_log** | number | 100 | æœ€å¤§æ—¥å¿—å­˜å‚¨é‡ï¼ˆâ‰¥5ï¼‰ | log=true |
| **log_type** | string[] | `['add','reduce']` | è®°å½•çš„æ“ä½œç±»å‹ï¼š<br>`get`-æŸ¥è¯¢ `set`-è®¾ç½®<br>`add`-å¢åŠ  `reduce`-å‡å°‘ | log=true |

## ç”¨æˆ·æŒ‡ä»¤
- æŸ¥è¯¢ç§¯åˆ†ï¼š`æŸ¥è¯¢ç§¯åˆ†`
  ç¤ºä¾‹å“åº”ï¼š`ğŸ… å½“å‰ç§¯åˆ†ï¼š1580`

## å¼€å‘è€…è°ƒç”¨


å¯¹äºæ‰€æœ‰apiï¼Œè¿”å›å€¼å‡ä¸ºä¸‹åˆ—æ ¼å¼ï¼š
```typescript
interface ApiResponse {
  code: number 
  // çŠ¶æ€ç ï¼Œç±»ä¼¼äºhttpçŠ¶æ€ç ï¼Œ200ä¸ºæˆåŠŸï¼Œ4xxä¸ºè°ƒç”¨æ–¹é”™è¯¯ï¼Œ5xxä¸ºæœåŠ¡é”™è¯¯
  msg: string 
  // ä¿¡æ¯ï¼Œåœ¨é”™è¯¯æ—¶å°†è¿”å›é”™è¯¯ä¿¡æ¯
  data?: any 
  // å¯é€‰ï¼Œå½“ä¸ºå–å€¼å‹apiæ—¶å°†è¿”å›å¯¹åº”çš„å€¼
}
```
ä½¿ç”¨å®ä¾‹ï¼š
```typescript
import { } from 'koishi-plugin-codegang-jf'

export const name = 'my-plugin'
export const inject = {
  required: ['jf']
}

export function apply(ctx: Context) {
  ctx.command('test').action(async ({ session }) => {
    ctx.jf.add(userId, 100, name)// å¢åŠ ç§¯åˆ†
    ctx.jf.get(userId, name)
    ctx.jf.getTopUsers(10, name)// è·å–ç§¯åˆ†æ¦œä¸ŠTOP10ç”¨æˆ·
  });
}

```

## æ—¥å¿—æŸ¥è¯¢ä¸æ•°æ®å›æ»š

æ­£åœ¨å¼€å‘ç›¸å…³æ’ä»¶ã€‚ç›®å‰æ‚¨å¯ä»¥ä½¿ç”¨[koishi-plugin-dataview](https://github.com/koishijs/koishi-plugin-dataview)ï¼Œé€‰æ‹©`codegang-jf-log`æ•°æ®è¡¨æŸ¥çœ‹ä¿å­˜çš„æ—¥å¿—


## âš ï¸ **æ³¨æ„äº‹é¡¹**
1. ç¡®ä¿å·²å®‰è£…æ•°æ®åº“æ”¯æŒ (`database` æœåŠ¡)
2. ç§¯åˆ†å€¼æ”¯æŒæ•´æ•°ç±»å‹
3. æ—¥å¿—ç³»ç»Ÿé‡‡ç”¨å¾ªç¯è¦†ç›–ç­–ç•¥
4. æ‰¹é‡æ“ä½œå»ºè®®æ·»åŠ äº‹åŠ¡å¤„ç†
5. å»ºè®®å®šæœŸå¤‡ä»½æ•°æ®åº“æ–‡ä»¶ï¼Œé˜²æ­¢å› å´©æºƒå¯¼è‡´çš„